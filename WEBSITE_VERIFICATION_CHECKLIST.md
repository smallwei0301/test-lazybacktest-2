# 🌐 網站驗證清單與結果記錄

**驗證日期**: 2025-11-17  
**驗證狀態**: ⏳ 進行中

---

## 📋 驗證清單

### ✅ 準備階段

- [x] 代碼文件已在本地驗證
- [x] P1 和 P2 日誌已確認完整
- [x] 網站資源文件已確認存在
- [ ] **接下來：執行瀏覽器驗證**

---

## 🎬 瀏覽器驗證步驟

### 【步驟 1】清除瀏覽器緩存

**操作**:
```
1. 按鍵: Ctrl+Shift+Delete
2. 選擇: 全部時間
3. 勾選: Cookies 及其他網站資料
4. 點擊: 清除資料
5. 完全關閉瀏覽器
6. 重新打開瀏覽器
```

**檢查**:
- [ ] 緩存已清除
- [ ] 瀏覽器已重啟

---

### 【步驟 2】訪問網站

**操作**:
```
1. 在瀏覽器地址欄輸入: https://test-lazybacktest.netlify.app
2. 按 Enter 訪問
3. 等待頁面完全加載
```

**檢查**:
- [ ] 網站成功加載
- [ ] 頁面顯示「批量優化」和「滾動測試」選項

---

### 【步驟 3】打開開發者工具

**操作**:
```
1. 按鍵: F12（或 右鍵 → 檢查 → Console）
2. 選擇: Console 選項卡
3. 清空現有日誌（點擊清空圖標）
```

**檢查**:
- [ ] Console 已打開
- [ ] Console 已清空
- [ ] 準備好記錄新日誌

---

### 【步驟 4】測試批量優化 - P1 驗證

**操作**:
```
1. 點擊進入「批量優化」頁面
2. 在「選擇進出場策略」中選擇 1-2 個策略
   例如: MA_cross + RSI_indicator
3. 設定「迭代次數」為 10（用於快速測試）
4. 點擊「開始優化」按鈕
```

**觀察 Console**:
```
預期看到的日誌消息:

[Batch Optimization] P1: Calculated lookback for strategies [ma_cross, rsi_indicator]: XX days
```

**記錄數據**:
- [ ] 看到了 P1 日誌消息
- [ ] 記錄 lookbackDays 值: **______ days**
- [ ] 記錄選擇的策略: **________________**

**範例記錄**:
```
批量優化 - P1 驗證結果:
  策略組合: MA_cross + RSI_indicator
  計算的 lookbackDays: 90 days
  日誌消息出現: ✅ 是
  時間戳: 09:50:00 AM
```

---

### 【步驟 5】測試批量優化 - P2 驗證

**觀察 Console**:
```
預期看到的日誌消息:

[Batch Optimization] P2: Using provided lookbackDays=XX from strategy calculation
```

**記錄數據**:
- [ ] 看到了 P2 日誌消息
- [ ] P2 中的 lookbackDays 值與 P1 一致

**範例記錄**:
```
批量優化 - P2 驗證結果:
  P2 日誌消息出現: ✅ 是
  P2 中 lookbackDays 值: 90 days
  與 P1 一致: ✅ 是
```

---

### 【步驟 6】測試批量優化 - 功能驗證

**觀察**:
```
1. 優化進程是否正常運行？
2. Console 中是否有紅色錯誤？
3. 優化是否完成？
4. 結果是否顯示？
```

**記錄數據**:
- [ ] 優化正常運行
- [ ] 無 JavaScript 錯誤
- [ ] 優化成功完成
- [ ] 結果表格顯示正常

---

### 【步驟 7】測試滾動測試 - P1 驗證

**操作**:
```
1. 清空 Console（點擊清空圖標）
2. 進入「滾動測試」頁面
3. 選擇相同的進出場策略（如 MA_cross + RSI_indicator）
4. 設定時間段和窗口參數
5. 點擊「開始測試」按鈕
```

**觀察 Console**:
```
預期看到的日誌消息:

[Rolling Test] P1: Calculated lookback for strategies [ma_cross, rsi_indicator]: XX days
```

**記錄數據**:
- [ ] 看到了 P1 日誌消息
- [ ] 記錄 lookbackDays 值: **______ days**

**範例記錄**:
```
滾動測試 - P1 驗證結果:
  策略組合: MA_cross + RSI_indicator
  計算的 lookbackDays: 90 days
  日誌消息出現: ✅ 是
```

---

### 【步驟 8】測試滾動測試 - P2 驗證

**觀察 Console**:
```
預期看到的日誌消息:

[Rolling Test] P2: Using provided lookbackDays=XX from strategy calculation
```

**記錄數據**:
- [ ] 看到了 P2 日誌消息
- [ ] P2 中的 lookbackDays 值與 P1 一致

---

### 【步驟 9】一致性驗證

**對比數據**:

| 項目 | 批量優化 | 滾動測試 | 一致性 |
|------|---------|---------|--------|
| 策略組合 | _______ | _______ | [ ] 一致 |
| P1 lookbackDays | ______ days | ______ days | [ ] 相同 |
| P2 lookbackDays | ______ days | ______ days | [ ] 相同 |
| 優化/測試狀態 | ✅ 完成 | ✅ 完成 | [ ] 正常 |

---

### 【步驟 10】功能回歸測試

**測試項目**:

- [ ] 批量優化可正常執行
- [ ] 滾動測試可正常執行
- [ ] Console 無紅色 JavaScript 錯誤
- [ ] 結果數據合理正確
- [ ] 網站無卡頓或超時

**記錄任何異常**:
```
發現的問題:
_________________________________
_________________________________
```

---

## 📊 驗證結果總結

### P0 驗證 (cachedMeta)

**本地檢查**: ✅ 通過
**網站驗證**: 
- [ ] cachedMeta 在 Network 中可見
- [ ] Worker 消息結構正確

**結果**: [ ] 通過 [ ] 失敗

---

### P1 驗證 (統一 Lookback)

**批量優化**:
- [ ] 日誌出現: ✅
- [ ] 計算值: ______ days

**滾動測試**:
- [ ] 日誌出現: ✅
- [ ] 計算值: ______ days

**一致性**: 
- [ ] 相同策略值一致: ✅
- [ ] 不同策略自動調整: ✅

**結果**: [ ] 通過 [ ] 失敗

---

### P2 驗證 (優先級系統)

**批量優化**:
- [ ] P2 日誌出現: ✅
- [ ] 優先級邏輯正確: ✅

**滾動測試**:
- [ ] P2 日誌出現: ✅
- [ ] 優先級邏輯正確: ✅

**結果**: [ ] 通過 [ ] 失敗

---

## ✅ 最終驗證結論

### 整體評估

```
P0 (cachedMeta):        [ ] 通過 [ ] 失敗
P1 (統一 Lookback):     [ ] 通過 [ ] 失敗
P2 (優先級系統):        [ ] 通過 [ ] 失敗
功能回歸:               [ ] 通過 [ ] 失敗
━━━━━━━━━━━━━━━━━━━━━━━━━
整體結果:               [ ] ✅ 全部通過
                        [ ] ⚠️  部分失敗
                        [ ] ❌ 未通過
```

### 驗證者信息

- **驗證人**: _________________
- **驗證時間**: _________________
- **瀏覽器版本**: _________________
- **測試環境**: 生產環境

### 備註

```
_________________________________________________________________
_________________________________________________________________
_________________________________________________________________
```

---

## 🐛 遇到問題？

### 常見問題排查

#### 問題 1: 看不到 P1 日誌消息

**症狀**: Console 中沒有 "[Batch Optimization] P1: Calculated lookback" 的消息

**原因**: 
- 瀏覽器緩存未完全清除
- 網站未加載新代碼
- 日誌輸出被過濾或禁用

**解決**:
1. 再次執行 Ctrl+Shift+Delete 清除所有緩存
2. 完全關閉瀏覽器（不是最小化）
3. 重新打開瀏覽器並訪問網站
4. 檢查 Console 過濾器是否隱藏了日誌
5. 嘗試使用無痕模式（Ctrl+Shift+N）測試

#### 問題 2: lookbackDays 值不一致

**症狀**: 批量優化和滾動測試中同一策略組合的值不同

**原因**:
- 選擇的策略實際上不同
- 優先級系統有 bug
- 時間範圍不同導致計算差異

**解決**:
1. 驗證兩側選擇的策略完全相同
2. 檢查 Console 中的策略 ID 是否一致
3. 查看完整的日誌消息確認策略清單
4. 截圖記錄具體的策略值和結果

#### 問題 3: 優化/測試出現錯誤

**症狀**: Console 中出現紅色錯誤信息

**原因**: 代碼部署不完整或有其他 bug

**解決**:
1. 記錄完整的錯誤信息（複製整個紅色消息）
2. 查看是否有 "buildBatchCachedMeta is not defined" 的錯誤
3. 查看是否有 "getRequiredLookbackForStrategies is not defined" 的錯誤
4. 若有此類錯誤，表示新代碼未正確部署

---

## 📸 推薦的截圖位置

驗證完成時，建議截圖以下內容：

1. **批量優化 - P1/P2 日誌**
   - 截圖 Console 中的 P1 和 P2 日誌

2. **滾動測試 - P1/P2 日誌**
   - 截圖 Console 中的 P1 和 P2 日誌

3. **優化結果**
   - 截圖批量優化完成後的結果表格

4. **測試結果**
   - 截圖滾動測試完成後的結果

5. **任何錯誤信息**
   - 如出現問題，截圖完整的錯誤堆棧

---

## 📤 驗證完成後

1. **保存此檔案**
   - 填寫完整的驗證結果
   - 記錄任何異常情況

2. **上傳結果**
   - 若全部通過，標記為「✅ 生產驗證通過」
   - 若有失敗，詳細記錄失敗原因

3. **後續行動**
   - 全部通過：可進行性能測試和負載測試
   - 部分失敗：需進一步調查和修復
   - 完全失敗：需檢查部署過程

---

**⏳ 準備好了嗎？按照上述步驟開始驗證！** 🚀

完成後將驗證結果更新到此檔案並告知結果。
