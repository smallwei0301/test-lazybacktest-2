# 🎯 網站驗證執行指南

**日期**: 2025-11-17  
**目標**: 按照檢查清單進行完整的網站驗證

---

## 📋 快速開始

### ✅ 已完成的準備工作

- ✅ 代碼修改已驗證 (本地 16/16 檢查通過)
- ✅ 文件已正確部署
- ✅ P1/P2 日誌已確認完整
- ✅ 所有資源文件已確認存在

### 🎬 現在執行

按照 **WEBSITE_VERIFICATION_CHECKLIST.md** 中的 10 個步驟進行驗證

---

## 📱 驗證前準備

### 必備環境

```
✓ 網絡連接正常
✓ 現代瀏覽器 (Chrome/Firefox/Edge)
✓ 開發者工具可用 (F12)
✓ 可寫文本編輯器（記錄結果）
```

### 預留時間

```
準備時間: 2-3 分鐘
測試時間: 5-10 分鐘
總計: 10-15 分鐘
```

---

## 🚀 驗證步驟速查表

### 第 1 階段：環境準備 (2 分鐘)

```
☐ 清除瀏覽器緩存 (Ctrl+Shift+Delete)
☐ 完全關閉瀏覽器
☐ 重新打開瀏覽器
☐ 驗證網絡連接正常
```

### 第 2 階段：批量優化驗證 (5 分鐘)

```
☐ 訪問: https://test-lazybacktest.netlify.app
☐ 打開: F12 → Console
☐ 進入: 批量優化頁面
☐ 選擇: 1-2 個進出場策略 (記錄名稱)
☐ 設定: 迭代次數 = 10
☐ 點擊: 開始優化
☐ 觀察: Console 日誌
┃  預期見到:
┃  [Batch Optimization] P1: Calculated lookback for strategies [...]: XX days
┃  [Batch Optimization] P2: Using provided lookbackDays=XX from strategy calculation
☐ 記錄: P1 計算的 lookbackDays 值 = _____ days
☐ 記錄: 選擇的策略 = _________________
☐ 驗證: Console 無紅色錯誤
☐ 驗證: 優化完成，結果顯示
```

### 第 3 階段：滾動測試驗證 (5 分鐘)

```
☐ 進入: 滾動測試頁面
☐ 選擇: 相同的進出場策略 (與第 2 階段相同)
☐ 設定: 其他參數
☐ 點擊: 開始測試
☐ 清空: Console 日誌後重新運行
☐ 觀察: Console 日誌
┃  預期見到:
┃  [Rolling Test] P1: Calculated lookback for strategies [...]: XX days
┃  [Rolling Test] P2: Using provided lookbackDays=XX from strategy calculation
☐ 記錄: P1 計算的 lookbackDays 值 = _____ days
☐ 驗證: 與批量優化的值一致
☐ 驗證: Console 無紅色錯誤
☐ 驗證: 測試完成，結果顯示
```

### 第 4 階段：結果驗證 (1 分鐘)

```
☐ 對比:
  - 批量優化 lookbackDays: _____ days
  - 滾動測試 lookbackDays: _____ days
  - 一致性: [ ] 相同 [ ] 不同
  
☐ 判斷:
  [ ] ✅ 全部通過
  [ ] ⚠️  部分失敗 (問題: ____________)
  [ ] ❌ 完全失敗 (原因: ____________)
```

---

## 📊 驗證結果記錄表

### 測試環境

| 項目 | 值 |
|------|-----|
| 驗證日期 | _____________ |
| 驗證時間 | _____________ |
| 瀏覽器 | 例: Chrome 131.0 |
| 網站 URL | https://test-lazybacktest.netlify.app |
| 測試模式 | 生產環境驗證 |

### 批量優化測試結果

| 檢查項 | 結果 | 備註 |
|--------|------|------|
| P1 日誌出現 | [ ] ✅ [ ] ❌ | 時間: ______ |
| P2 日誌出現 | [ ] ✅ [ ] ❌ | 時間: ______ |
| lookbackDays 值 | ______ days | 策略: _____________ |
| Console 無錯誤 | [ ] ✅ [ ] ❌ | 錯誤數: ______ |
| 優化完成 | [ ] ✅ [ ] ❌ | 耗時: ______ |
| 結果合理 | [ ] ✅ [ ] ❌ | 備註: _____________ |

### 滾動測試測試結果

| 檢查項 | 結果 | 備註 |
|--------|------|------|
| P1 日誌出現 | [ ] ✅ [ ] ❌ | 時間: ______ |
| P2 日誌出現 | [ ] ✅ [ ] ❌ | 時間: ______ |
| lookbackDays 值 | ______ days | 策略: _____________ |
| 與批量優化一致 | [ ] ✅ [ ] ❌ | 差異: ______ |
| Console 無錯誤 | [ ] ✅ [ ] ❌ | 錯誤數: ______ |
| 測試完成 | [ ] ✅ [ ] ❌ | 耗時: ______ |

### 一致性驗證

```
批量優化 lookbackDays:   _____ days
滾動測試 lookbackDays:   _____ days
                        ─────────────
差異:                    _____ days

[ ] 相同 (一致性驗證通過)
[ ] 不同 (需調查原因)
```

### 功能回歸驗證

| 功能 | 狀態 | 備註 |
|------|------|------|
| 批量優化功能 | [ ] ✅ [ ] ❌ | _____________ |
| 滾動測試功能 | [ ] ✅ [ ] ❌ | _____________ |
| 網頁響應速度 | [ ] 正常 [ ] 緩慢 | _____________ |
| 數據顯示正確 | [ ] ✅ [ ] ❌ | _____________ |
| 無卡頓卡死 | [ ] ✅ [ ] ❌ | _____________ |

---

## ✅ 最終驗證結論

### P0 驗證 (cachedMeta 傳遞)

**本地檢查結果**: ✅ 通過

**網站驗證檢查表**:
- [ ] 在 Network 選項卡中可見 cachedMeta
- [ ] cachedMeta 包含正確的字段結構
- [ ] Worker 消息格式正確

**網站驗證結果**: [ ] ✅ 通過 [ ] ❌ 失敗

---

### P1 驗證 (統一 Lookback 計算)

**本地檢查結果**: ✅ 通過 (6/6)

**網站驗證檢查表**:
- [ ] 批量優化顯示 P1 日誌: `[Batch Optimization] P1: Calculated lookback for strategies [...]: XX days`
- [ ] 滾動測試顯示 P1 日誌: `[Rolling Test] P1: Calculated lookback for strategies [...]: XX days`
- [ ] 相同策略組合的 lookbackDays 值完全相同
- [ ] lookbackDays 計算邏輯正確

**網站驗證結果**: [ ] ✅ 通過 [ ] ❌ 失敗

---

### P2 驗證 (優先級系統)

**本地檢查結果**: ✅ 通過 (4/4)

**網站驗證檢查表**:
- [ ] 批量優化顯示 P2 日誌: `[Batch Optimization] P2: Using provided lookbackDays=XX from strategy calculation`
- [ ] 滾動測試顯示 P2 日誌: `[Rolling Test] P2: Using provided lookbackDays=XX from strategy calculation`
- [ ] P2 日誌在 P1 之後出現
- [ ] 優先級系統按預期工作

**網站驗證結果**: [ ] ✅ 通過 [ ] ❌ 失敗

---

### 功能回歸驗證

**檢查項**:
- [ ] 批量優化功能正常
- [ ] 滾動測試功能正常
- [ ] 無新的 JavaScript 錯誤
- [ ] 數據計算結果合理
- [ ] 網站性能無明顯下降

**功能回歸結果**: [ ] ✅ 通過 [ ] ❌ 失敗

---

## 🎯 整體驗證結論

```
╔═══════════════════════════════════════════╗
║          網站驗證最終結果                  ║
╠═══════════════════════════════════════════╣
║ P0 (cachedMeta):        [ ] ✅ [ ] ❌  ║
║ P1 (統一 Lookback):     [ ] ✅ [ ] ❌  ║
║ P2 (優先級系統):        [ ] ✅ [ ] ❌  ║
║ 功能回歸:               [ ] ✅ [ ] ❌  ║
╠═══════════════════════════════════════════╣
║ 整體結果:               [ ] ✅ [ ] ❌  ║
╚═══════════════════════════════════════════╝
```

### 驗證者簽名

- **驗證人**: _____________________
- **簽署日期**: _____________________
- **簽署時間**: _____________________

### 備註和異常情況

```
_________________________________________________________________

_________________________________________________________________

_________________________________________________________________

_________________________________________________________________
```

---

## 🐛 故障排查速查表

### 看不到 P1 日誌？

```
快速檢查清單:
☐ 緩存已完全清除 (Ctrl+Shift+Delete 選擇全部時間)
☐ 瀏覽器已完全關閉並重新打開
☐ 在無痕模式中重新嘗試 (Ctrl+Shift+N)
☐ 切換瀏覽器 (嘗試 Firefox 或 Edge)
☐ 檢查 Console 過濾器 (查看是否隱藏了日誌)
☐ 刷新頁面 (Ctrl+F5 強制刷新)

若仍未出現，可能的原因:
❌ 新代碼未正確部署
❌ 網站使用了舊版本
❌ shared-lookback.js 未加載
```

### lookbackDays 值不一致？

```
快速檢查清單:
☐ 驗證兩側選擇的策略名稱完全相同
☐ 檢查 Console 中的策略 ID 是否一致
☐ 查看是否有 P1 計算時的策略清單日誌
☐ 檢查是否在不同的訓練數據範圍下測試

常見原因:
⚠️  實際選擇的策略不同
⚠️  優先級系統有問題
⚠️  時間範圍不同導致計算差異
```

### 優化/測試出現錯誤？

```
快速檢查清單:
☐ 複製完整的紅色錯誤信息
☐ 檢查是否有 "buildBatchCachedMeta is not defined"
☐ 檢查是否有 "getRequiredLookbackForStrategies is not defined"
☐ 檢查是否有其他 JavaScript 語法錯誤

若有上述錯誤，表示:
❌ P0 或 P1 的代碼未正確部署
❌ 需要重新檢查部署過程
```

---

## 📸 推薦截圖清單

為了完整記錄驗證結果，建議截圖以下畫面：

```
☐ 截圖 1: 批量優化 P1 日誌消息
☐ 截圖 2: 批量優化 P2 日誌消息
☐ 截圖 3: 滾動測試 P1 日誌消息
☐ 截圖 4: 滾動測試 P2 日誌消息
☐ 截圖 5: 批量優化完成結果
☐ 截圖 6: 滾動測試完成結果
☐ 截圖 7: 任何異常情況的完整錯誤信息
```

---

## 📤 驗證完成後

### 下一步行動

根據驗證結果：

**✅ 全部通過**:
1. 在此檔案上方記錄「✅ 驗證通過」
2. 可進行性能測試和負載測試
3. 準備生產環境全面驗證

**⚠️  部分失敗**:
1. 詳細記錄失敗項目和原因
2. 提交 bug 報告，包含截圖和日誌
3. 進行針對性修復

**❌ 完全失敗**:
1. 檢查是否部署過程有誤
2. 驗證代碼文件是否已上傳
3. 檢查 Netlify 部署日誌

---

## 📚 相關資源

- [WEBSITE_VERIFICATION_CHECKLIST.md](./WEBSITE_VERIFICATION_CHECKLIST.md) - 詳細檢查清單
- [DEPLOYMENT_VERIFICATION_SUMMARY.md](./DEPLOYMENT_VERIFICATION_SUMMARY.md) - 部署驗證總結
- [WEBSITE_VALIDATION_REPORT.json](./WEBSITE_VALIDATION_REPORT.json) - 驗證報告數據
- [TEST_VERIFICATION_GUIDE.md](./TEST_VERIFICATION_GUIDE.md) - 完整測試指南
- [IMPLEMENTATION_SUMMARY.md](./IMPLEMENTATION_SUMMARY.md) - 施作詳解

---

**🎬 準備開始驗證了嗎？** 

按照上述步驟進行驗證，完成後更新本文件的驗證結果。祝驗證順利！ 🚀

