# OFI æŒ‡æ¨™æ‹†è§£èˆ‡è¦æ ¼å°ç…§ï¼ˆLB-OFI-DOCS-20251014Aï¼‰

> é©ç”¨æ¨¡çµ„ï¼š`LB-OFI-ISLANDTIP-20251014A`

æœ¬æ–‡ä»¶å°‡æ‰¹é‡å„ªåŒ–æµç¨‹ä¸­æ¯ä¸€å€‹ OFI æ§‹é¢ã€å­åˆ†æ•¸èˆ‡å¯¦ä½œç´°ç¯€å®Œæ•´å±•é–‹ï¼Œä¸¦èˆ‡åŸå§‹è¦æ ¼æ¯”å°å·®ç•°èˆ‡å½±éŸ¿ï¼Œæ–¹ä¾¿å‰å¾Œç«¯å·¥ç¨‹å¸«èˆ‡ç”¢å“å¤¥ä¼´è¿½è¹¤ã€‚

---

## 0. å‰ç½®è¨­å®š

- å›æ¸¬çµæœæœƒå…ˆè½‰ç‚º**æ—¥å ±é…¬åºåˆ—**ï¼Œè‹¥è³‡æ–™é‡é”åˆ° `desiredSegments`ï¼ˆé è¨­ 10 æ®µï¼‰æ‰é€²å…¥ OFI åˆ†æã€‚
- ä¾åºåˆ‡æˆ `S` å€‹é€£çºŒå€å¡Šï¼Œæ¡ã€Œ**å¹³å‡åˆ†é… + å‰æ®µè£œä¸€ç­†**ã€ç­–ç•¥ç¢ºä¿ç¸½æ¨£æœ¬è¢«ç”¨ç›¡ã€‚ã€F:js/overfit-score.jsâ€ L248-L270ã€‘
- èšåˆå­é è¨­ä½¿ç”¨ä¸­ä½æ•¸ï¼ˆ`median`ï¼‰ï¼Œäº¦å¯é€éè¨­å®šæ”¹ç‚ºå¹³å‡æ•¸ï¼ˆ`mean`ï¼‰ã€‚ã€F:js/overfit-score.jsâ€ L276-L288ã€‘

---

## 1. Flow å±¤ç´šï¼ˆå…¨é«”ç­–ç•¥å…±ç”¨ï¼‰

### 1.1 PBOï¼ˆProbability of Backtest Overfittingï¼‰

1. ç‚ºæ¯å€‹ CSCV åˆ‡åˆ†çµ„åˆè¨ˆç®— IS / OOS èšåˆå€¼ã€‚
2. å– IS å† è»ä¸¦æ¯”è¼ƒå…¶ OOS è¡¨ç¾çš„åˆ†ä½æ•¸ `q`ï¼Œä¹‹å¾Œå¥—ç”¨ `\lambda = \log\frac{q}{1-q}`ã€‚
3. `PBO = Pr(\lambda < 0)`ï¼Œæœ€çµ‚è½‰æˆ `R^{PBO} = 1 - PBO`ã€‚

**å·®ç•° & å½±éŸ¿**
- å¯¦ä½œé¡å¤–å° `q` åšé‚Šç•Œå¤¾ä½ï¼ˆclampï¼‰ï¼Œé¿å…æ’åè½åœ¨ 0 æˆ– 1 æ™‚å‡ºç¾ç„¡é™å¤§çš„ `\lambda`ã€‚ã€F:js/overfit-score.jsâ€ L308-L352ã€‘
- è‹¥ OOS èšåˆå€¼ä¸è¶³å‰‡è·³éè©²åˆ‡åˆ†ï¼Œé™ä½æ¥µç«¯æ¨£æœ¬æ±¡æŸ“çµæœã€‚
- èˆ‡åŸè¦æ ¼é‚è¼¯ä¸€è‡´ï¼Œåƒ…å¢åŠ æ•¸å€¼ç©©å®šæ€§ã€‚

### 1.2 æ¨£æœ¬é•·åº¦å……è¶³åº¦ `R^{Len}`

- å–å¾—æ‰€æœ‰æœ‰æ•ˆç­–ç•¥çš„æ—¥å ±é…¬ç­†æ•¸ä¸­ä½æ•¸ï¼Œä½œç‚ºæ¨£æœ¬é•·åº¦ `T`ã€‚ã€F:js/overfit-score.jsâ€ L354-L402ã€‘
- ä¾ `T` ä½ç½®çµ¦åˆ†ï¼š`T < 250 â†’ 0`ã€`250 â‰¤ T < 500 â†’ 0.5`ã€`T â‰¥ 500 â†’ 1`ï¼Œå°æ‡‰ block bootstrap æ˜¯å¦å¯è¡Œã€‚ã€F:js/overfit-score.jsâ€ L354-L402ã€‘
- åŒæ­¥è¼¸å‡ºå»ºè­°çš„ block é•·åº¦ `T^{1/3}` èˆ‡æ–‡å­—æ¨™ç±¤ï¼ˆä¸è¶³ï¼åå¼±ï¼å……è¶³ï¼‰ï¼Œä¾› UI æé†’æ¨£æœ¬æ˜¯å¦é”æ¨™ã€‚ã€F:js/overfit-score.jsâ€ L354-L402ã€‘

### 1.3 ç­–ç•¥æ± å»£åº¦ `R^{Pool}`

- ä»¥æœ‰æ•ˆç­–ç•¥æ•¸ `K` ç‚ºåŸºæº–ï¼š`K < 20 â†’ 0`ã€`20 â‰¤ K < 100 â†’ 0.7`ã€`K â‰¥ 100 â†’ 1`ï¼Œè©•ä¼°ç­–ç•¥æ± æ˜¯å¦è¶³å¤ å»£æ³›ã€‚ã€F:js/overfit-score.jsâ€ L404-L426ã€‘
- æ¨™è¨˜ç­–ç•¥æ± ç‹€æ…‹ï¼ˆéå°ï¼åˆç†ï¼å……è¶³ï¼‰ï¼Œè®“å‰ç«¯å¯ç›´æ¥åœ¨ Flow å¡ç‰‡é¡¯ç¤ºå»ºè­°ã€‚ã€F:js/overfit-score.jsâ€ L404-L426ã€‘

### 1.4 SPA èˆ‡ MCS

- **SPA**ï¼šè’é›† `spaPValue` ç­‰æ¬„ä½ï¼Œçµ±è¨ˆå°æ–¼ `\alpha`ï¼ˆé è¨­ 0.1ï¼‰çš„ç­–ç•¥å æ¯”ä½œç‚º `R^{SPA}`ã€‚ã€F:js/overfit-score.jsâ€ L428-L442ã€‘
- **MCS**ï¼šæ ¹æ“š `mcsSurvivor/mcsInclusion/mcsRank` ç­‰æ——æ¨™ï¼Œè¨ˆç®—å­˜æ´»ç­–ç•¥æ¯”ç‡ä½œç‚º `R^{MCS}`ã€‚ã€F:js/overfit-score.jsâ€ L444-L470ã€‘

**å·®ç•° & å½±éŸ¿**
- è‹¥ä¼ºæœç«¯å°šæœªå›å¡«å°æ‡‰æ¬„ä½ï¼Œåˆ†æ•¸æœƒç‚º `null`ï¼Œå¾ŒçºŒåŠ æ¬Šæ™‚è‡ªå‹•é‡æ–°æ­£è¦åŒ–æœ‰æ•ˆæ¬Šé‡ï¼Œé¿å…å› ç¼ºè³‡æ–™å°è‡´ç¸½åˆ†å´©æ½°ã€‚ã€F:js/overfit-score.jsâ€ L310-L350ã€‘ã€F:js/overfit-score.jsâ€ L404-L476ã€‘

### 1.5 FlowScoreï¼ˆç¸½åˆ†èˆ‡é–€æª»ï¼‰

- `R^{Flow} = 0.40 R^{PBO} + 0.20 R^{Len} + 0.15 R^{Pool} + 0.15 R^{SPA} + 0.10 R^{MCS}`ã€‚ã€F:js/overfit-score.jsâ€ L308-L352ã€‘ã€F:js/overfit-score.jsâ€ L428-L476ã€‘
- `FlowScore = 100 Â· R^{Flow}`ï¼ŒåŒæ™‚è¼¸å‡ºæ–‡å­—åˆ¤å®šï¼š`â‰¥70` åˆæ ¼ã€`50â€“69` é‚Šç•Œã€`<50` ä¸åˆæ ¼ã€‚ã€F:js/overfit-score.jsâ€ L308-L352ã€‘ã€F:js/overfit-score.jsâ€ L308-L352ã€‘
- FlowScore ä¸åˆæ ¼æ™‚æœƒæ¨™è¨˜ `allowStrategyRanking = false`ï¼ŒUI ç›´æ¥é–å®šç­–ç•¥æ’åºä¸¦é¡¯ç¤ºæ”¹å–„å»ºè­°ï¼ˆå»¶é•·æ¨£æœ¬ã€æ“´å……ç­–ç•¥æ± ç­‰ï¼‰ã€‚ã€F:js/overfit-score.jsâ€ L308-L352ã€‘ã€F:js/overfit-score.jsâ€ L354-L402ã€‘ã€F:js/overfit-score.jsâ€ L404-L476ã€‘ã€F:js/batch-optimization.jsâ€ L1685-L1905ã€‘

---

## 2. ç­–ç•¥å±¤ç´šï¼ˆé€ç­–ç•¥ï¼‰

### 2.1 OOS ç©©å¥æ€§ï¼ˆCSCV åˆ†å¸ƒï¼‰

- æ”¶é›†æ¯å€‹ç­–ç•¥åœ¨æ‰€æœ‰åˆ‡åˆ†çš„ OOS èšåˆå€¼ï¼Œè¨ˆç®—ä¸­ä½æ•¸ `\tilde m_k` èˆ‡ IQRã€‚ã€F:js/overfit-score.jsâ€ L668-L696ã€‘
- ä¸­ä½æ•¸ã€IQR åˆ†åˆ¥ä½¿ç”¨ P10/P90 é‡åŒ–å¾Œå¤¾ä½åˆ° [0,1]ï¼Œå¾—åˆ° `mid_norm` èˆ‡ `iqr_norm`ã€‚ã€F:js/overfit-score.jsâ€ L690-L695ã€‘
- `R^{OOS}_k = 0.6 Â· mid_norm + 0.4 Â· (1 - iqr_norm)`ã€‚ã€F:js/overfit-score.jsâ€ L694-L695ã€‘

**å·®ç•° & å½±éŸ¿**
- ç•¶ç­–ç•¥ IQR ç„¡æ³•ä¼°è¨ˆï¼ˆæ¨£æœ¬ä¸è¶³ï¼‰æ™‚ï¼Œå¯¦ä½œæœƒå°‡ `iqr_norm` è¦–ç‚º 1ï¼Œç­‰åŒçµ¦äºˆæœ€ä½ç©©å¥åº¦ï¼Œæé†’ä½¿ç”¨è€…æ¨£æœ¬ä¸è¶³ã€‚ã€F:js/overfit-score.jsâ€ L690-L692ã€‘
- æ­¤åšæ³•è¼ƒåŸè¦æ ¼ä¿å®ˆï¼Œé¿å…æ¥µå°‘æ•¸ OOS æ ·æœ¬è¢«èª¤åˆ¤ç‚ºç©©å®šã€‚

### 2.2 Walk-forwardï¼ˆæ»¾å‹•è¦–çª—ï¼‰

- ä¾è¨­å®šçš„è¨“ç·´ã€æ¸¬è©¦çª—é€²è¡Œæ»‘å‹•åˆ‡åˆ†ï¼Œæ¸¬è©¦æ®µç´¯ç©å ±é…¬æ­£å€¼è¦–ç‚ºå‹å ´ï¼Œä¸¦è¨ˆç®—å¹³å‡æ¸¬è©¦å ±é…¬ã€‚ã€F:js/overfit-score.jsâ€ L525-L579ã€‘
- `R^{WF}_k = 0.6 Â· WR + 0.4 Â· ret_norm`ï¼Œå…¶ä¸­ `ret_norm` ä»æ¡ P10/P90 æ­£è¦åŒ–ã€‚ã€F:js/overfit-score.jsâ€ L719-L726ã€‘

**å·®ç•° & å½±éŸ¿**
- ç´¯ç©å ±é…¬ä»¥æ¸¬è©¦è¦–çª—å…§ã€Œæ—¥å ±é…¬ç¸½å’Œã€è¿‘ä¼¼åŸè¦æ ¼çš„ `\bar r_k`ã€‚å°çŸ­è¦–çª—ä¾†èªªç­‰æ•ˆæ–¼å¹³å‡å ±é…¬ï¼›å°é•·è¦–çª—å‰‡æ›´è²¼è¿‘å¯¦éš›è³‡é‡‘æ›²ç·šçš„ç›¸å°è®ŠåŒ–ã€‚

### 2.3 IslandScoreï¼ˆåƒæ•¸æ•æ„Ÿåº¦ï¼‰

- ä»¥ç­–ç•¥åƒæ•¸ç‚ºè»¸é‡å»ºç†±åœ–ï¼Œè¨­å®šé–€æª» `\tau = P75(G)`ï¼Œä½¿ç”¨ 8 é€£é€šå…ƒå°‹æ‰¾é«˜åŸå³¶å¶¼ã€‚ã€F:js/overfit-score.jsâ€ L644-L811ã€‘
- æ¯åº§å³¶è¨ˆç®—ï¼š
  - é¢ç© `A_j`ã€
  - å³¶å…§ IQR `D_j`ã€
  - é‚Šç·£æ‡²ç½° `E_j = \frac{\mu_{core} - \mu_{edge}}{|\mu_{core}| + \varepsilon}`ã€‚ã€F:js/overfit-score.jsâ€ L812-L860ã€‘
- å…ˆä»¥ P25/P95 åšç©©å¥æ­£è¦åŒ–å¾Œæ±‚å‡º `S_j = A^{norm}_j Â· (1 - D^{norm}_j) Â· (1 - E^{pen}_j)`ï¼Œæœ€å¾Œå†é™¤ä»¥æ‰€æœ‰å³¶çš„ `max S_j`ï¼Œå¾—åˆ° `R^{Island}_k`ã€‚ã€F:js/overfit-score.jsâ€ L864-L868ã€‘ã€F:js/overfit-score.jsâ€ L871-L894ã€‘

**å·®ç•° & å½±éŸ¿**
- æ–°å¢ `max S_j` æ­¥é©Ÿï¼Œç¢ºä¿æœ€ä½³å³¶å¶¼åˆ†æ•¸è¢«æ‹‰åˆ° 1ï¼Œèˆ‡åŸè¦æ ¼å®Œå…¨ä¸€è‡´ä¸¦ç¶­æŒç›¸å°æ’åºã€‚ã€F:js/overfit-score.jsâ€ L914-L958ã€‘
- ä¿®æ­£ `normaliseWithQuantiles` åœ¨åˆ†ä½ç¯„åœå¡Œç¸®æ™‚å›å‚³ 1 çš„å•é¡Œï¼Œç¾åœ¨å¹³å¦é‚Šç·£æœƒç¶­æŒ 0 æ‡²ç½°ï¼Œç¬¦åˆ Lopez deâ€¯Prado å°å¹³å¦å³¶å¶¼çµ¦å‡ºæœ€é«˜åˆ†çš„å®šç¾©ã€‚ã€F:js/overfit-score.jsâ€ L1267-L1283ã€‘
- è‹¥ç„¡æ³•å»ºæ§‹å³¶å¶¼ï¼ˆåƒæ•¸è»¸ä¸è¶³æˆ–åƒ…æœ‰å°–å³°ï¼‰æœƒä¸»å‹•å›å‚³ `R^{Island}_k = 0` èˆ‡æç¤ºè¨Šæ¯ï¼Œé¿å… UI é¡¯ç¤ºç©ºç™½ã€‚ã€F:js/overfit-score.jsâ€ L1202-L1224ã€‘
- é‡å°ã€Œåƒ…æœ‰ä¸€å€‹æ•¸å€¼åƒæ•¸ã€æˆ–ã€Œé€²å‡ºå ´åƒæ•¸åç¨±é‡è¤‡ã€ç­‰æƒ…å¢ƒï¼Œé¡å¤–å›å‚³ `duplicate_param_names` ç­‰è¨ºæ–·ï¼ŒUI æœƒé¡¯ç¤ºã€Œåƒæ•¸åç¨±é‡è¤‡æœƒå°è‡´ç†±å³¶ç‚º 0ã€æé†’ã€‚ã€F:js/overfit-score.jsâ€ L815-L905ã€‘ã€F:js/overfit-score.jsâ€ L922-L1035ã€‘ã€F:js/batch-optimization.jsâ€ L2084-L2119ã€‘
- `meta` æœƒå›å‚³é¢ç©ã€åˆ†å¸ƒã€åŸå§‹åˆ†æ•¸ç­‰è³‡è¨Šï¼Œä¾› UI/è¨ºæ–·ä½¿ç”¨ã€‚ã€F:js/overfit-score.jsâ€ L880-L893ã€‘

### 2.4 DSRï¼PSRï¼ˆé¡¯è‘—æ€§ï¼‰

- å…ˆå– `rawResult.sharpeRatio` èˆ‡æ¨£æœ¬æ•¸ä¼°è¨ˆ PSRã€ä»¥ logistic (`Î·=0.5`) è¿‘ä¼¼ DSRã€‚ã€F:js/overfit-score.jsâ€ L768-L812ã€‘
- è‹¥ä¼ºæœç«¯å‚³å› `psr` / `dsr` æ©Ÿç‡ï¼Œå¯¦ä½œæœƒèˆ‡è¿‘ä¼¼å€¼ä¸€ä½µå–æœ€å¤§å€¼ä½œç‚º `R^{DSR/PSR}_k`ã€‚ã€F:js/overfit-score.jsâ€ L780-L793ã€‘

**å·®ç•° & å½±éŸ¿**
- ç›®å‰å‰ç«¯ä½¿ç”¨ Sharpe ä¼°è¨ˆä½œç‚ºæš«æ™‚æ›¿ä»£ï¼Œå¾…ä¼ºæœç«¯ block bootstrap çµæœå›å¡«å¾Œæœƒè‡ªå‹•æ¡ç”¨å¾Œç«¯å€¼ï¼Œé¿å…é›™æ–¹ä¸ä¸€è‡´ã€‚
- è‹¥ Sharpe æˆ–æ¨£æœ¬ä¸è¶³æœƒå›å‚³ `null`ï¼Œæé†’éœ€è¦æ›´å¤šè³‡æ–™ã€‚

### 2.5 ç­–ç•¥å±¤ç¶œåˆ

- `R^{Strategy}_k = 0.25 R^{DSR/PSR}_k + 0.25 R^{OOS}_k + 0.25 R^{WF}_k + 0.25 R^{Island}_k`ï¼Œç¼ºå€¼è¦–ç‚º 0 åˆ†ä¸¦ä¿æŒåŸæ¬Šé‡ï¼Œèˆ‡è¦æ ¼å®Œå…¨å°é½Šã€‚ã€F:js/overfit-score.jsâ€ L1131-L1162ã€‘ã€F:js/overfit-score.jsâ€ L1217-L1233ã€‘
- `components` åŒæ­¥å›å‚³ `RStrategy`ï¼ˆ0â€“1ï¼‰èˆ‡ç™¾åˆ†æ¯”ï¼Œä»¥åŠ Flow/Strategy å°æœ€çµ‚ OFI çš„è²¢ç»ï¼Œä¾¿æ–¼ tooltip èˆ‡äº¤å‰é©—è­‰ã€‚ã€F:js/overfit-score.jsâ€ L1140-L1161ã€‘

---

## 3. æœ€çµ‚ OFIï¼ˆ0â€“100ï¼‰

- `OFI_k = 100 Â· (0.30 Â· R^{Flow} + 0.70 Â· R^{Strategy}_k)`ï¼Œè‹¥ Flow æˆ– Strategy ç¼ºå€¼å‰‡ä»¥ 0 åˆ†è™•ç†ä½†ä»ç¶­æŒåŸæ¬Šé‡ï¼›æœ€çµ‚å€¼èˆ‡è²¢ç»æ‹†è§£å­˜æ–¼ `components.finalOfi*` èˆ‡ `meta.finalOfi` ä¾›é©—è­‰ã€‚ã€F:js/overfit-score.jsâ€ L1131-L1161ã€‘ã€F:js/overfit-score.jsâ€ L1235-L1262ã€‘
- åŒæ­¥è¼¸å‡ºè©•èªï¼šã€ŒğŸ‘ ç©©å¥ï¼âœ… è‰¯å¥½ï¼ğŸ˜ ä¸€èˆ¬ï¼âš ï¸ é«˜é¢¨éšªï¼è³‡æ–™ä¸è¶³ã€ã€‚ã€F:js/overfit-score.jsâ€ L1163-L1172ã€‘
- æ‰¹é‡å„ªåŒ–è¡¨æ ¼ç›´æ¥é¡¯ç¤ºæœ€çµ‚ `OFI_k`ï¼ˆ0â€“100ï¼‰ï¼Œä¸¦åœ¨ tooltip èˆ‡æŒ‡æ¨™æ¬„ä½åŒæ­¥åˆ—å‡º Flow èˆ‡ Strategy å­åˆ†æ•¸ï¼›Flow æ©«å¹…ä¾èˆŠè² è²¬æ•´é«”åˆ¤å®šèˆ‡æ”¹å–„å»ºè­°ã€‚ã€F:js/batch-optimization.jsâ€ L1890-L1932ã€‘ã€F:js/batch-optimization.jsâ€ L2069-L2162ã€‘

### 3.1 èˆ‡åŸè¦æ ¼ / æ–‡ç»çš„æ¯”è¼ƒ

- **OOS ç©©å¥åº¦**ï¼šç¶­æŒè¦æ ¼çš„ä¸­ä½æ•¸ + IQR çµ„åˆï¼›ç•¶ IQR ç„¡æ³•ä¼°è¨ˆæ™‚ä»¥ 0 åˆ†è™•ç†ï¼Œèˆ‡ Bailey et al. (2017) å°æ–¼æ¨£æœ¬ä¸è¶³éœ€é™ä½ä¿¡è³´åº¦çš„å»ºè­°ä¸€è‡´ã€‚ã€F:js/overfit-score.jsâ€ L735-L773ã€‘
- **Walk-forward**ï¼šæ¡ç”¨æ¸¬è©¦çª—æ—¥å ±é…¬ç¸½å’Œè¿‘ä¼¼å¹³å‡å ±é…¬ï¼Œå°çŸ­è¦–çª—èˆ‡åŸæ–‡å®Œå…¨ç­‰åƒ¹ï¼Œå°é•·è¦–çª—å‰‡æ›´è²¼è¿‘è³‡é‡‘æ›²ç·šï¼›å‹ç‡å®šç¾©èˆ‡è¦æ ¼ä¸€è‡´ã€‚ã€F:js/overfit-score.jsâ€ L775-L851ã€‘
- **IslandScore**ï¼šæ²¿ç”¨ Lopez de Prado (2018) çš„é«˜åŸæ¢å‹˜ï¼Œå¦åœ¨ç„¡å³¶æ™‚å›å‚³ 0 åˆ†èˆ‡æç¤ºè¨Šæ¯ï¼Œæé†’éœ€è¦è£œé½Šåƒæ•¸ç¶²æ ¼æˆ–æå‡å¯†åº¦ã€‚ã€F:js/overfit-score.jsâ€ L902-L1107ã€‘
- **DSR/PSR**ï¼šè‹¥ä¼ºæœç«¯å°šæœªå›å‚³ bootstrap çµæœï¼Œå‰ç«¯ä»¥ Sharpe è¿‘ä¼¼ Probability/Deflated Sharpe Ratioï¼›æ­¤è¿‘ä¼¼è¼ƒä¿å®ˆï¼Œå¾…å¾Œç«¯è¦†è“‹å³å¯å›åˆ°æ–‡ç»è¨ˆç®—ã€‚ã€F:js/overfit-score.jsâ€ L853-L900ã€‘

ä¸Šè¿°èª¿æ•´çš†å±¬ç©©å¥æ€§å¼·åŒ–ï¼šåƒ…åœ¨è³‡æ–™ä¸è¶³æˆ–ä¼ºæœç«¯å°šæœªå›å¡«æ™‚æä¾›ä¿å®ˆä¼°è¨ˆï¼Œä¸æœƒæ”¹è®Šåˆæ ¼ç­–ç•¥é–“çš„ç›¸å°æ’åºã€‚

---

## 4. UI èˆ‡è¼¸å‡ºæ¬„ä½

- `computeOFIForResults` æœƒå›å‚³ `flow` ç‰©ä»¶ï¼ˆå« `PBO/q/Î»` åˆ†å¸ƒï¼‰èˆ‡æ¯å€‹ç­–ç•¥çš„ `components`ï¼›çµæœè¡¨ tooltip èˆ‡æŒ‡æ¨™æ¬„ä½æœƒåŒæ™‚åˆ—å‡º Flow èˆ‡ Strategy å­åˆ†æ•¸ä¸¦ä¿ç•™ Flow åˆ¤å®šèˆ‡ Island æç¤ºï¼Œæ–¹ä¾¿å¿«é€Ÿå°ç…§å…©å±¤è©•åˆ†ã€‚ã€F:js/batch-optimization.jsâ€ L1889-L2162ã€‘
- FlowScore é€é `renderOfiFlowBanner` å‘ˆç¾æ–¼çµæœå¡ç‰‡ä¸Šï¼Œæœƒé¡¯ç¤ºæ¨£æœ¬é•·åº¦ï¼ç­–ç•¥æ± ç‹€æ…‹èˆ‡æ”¹å–„å»ºè­°ï¼Œä¸¦åœ¨ FlowScore < 50 æ™‚é–å®šæ’åºæŒ‰éˆ•èˆ‡çµæœåˆ—ã€‚ã€F:js/batch-optimization.jsâ€ L1685-L1905ã€‘ã€F:js/batch-optimization.jsâ€ L2441-L2515ã€‘
- IslandScore `meta` æœƒæä¾›å³¶å¶¼åŸå§‹åˆ†æ•¸ã€æ­£è¦åŒ–å€¼èˆ‡ç¼ºå³¶æç¤ºï¼Œtooltip äº¦æœƒé¡¯ç¤ºã€ŒIsland æç¤ºã€å”åŠ©å®šä½åƒæ•¸ç¶²æ ¼ä¸è¶³ã€‚ã€F:js/overfit-score.jsâ€ L880-L1119ã€‘ã€F:js/batch-optimization.jsâ€ L2069-L2162ã€‘

---

## 5. è¦æ ¼å·®ç•°ç¸½è¡¨

| æ¨¡çµ„ | è¦æ ¼å·®ç•° | å½±éŸ¿è©•ä¼° |
| --- | --- | --- |
| PBO | clamp `q` é¿å… 0/1ï¼Œå¿½ç•¥ç¼ºå¤±åˆ‡åˆ† | åƒ…æå‡ç©©å®šæ€§ï¼Œä¸æ”¹è®Šæ•´é«”å®šç¾©ã€‚ã€F:js/overfit-score.jsâ€ L313-L345ã€‘ |
| OOS | IQR ç¼ºå€¼è¦–ç‚ºæœ€å·®ï¼Œé˜²æ­¢æ¨£æœ¬éå°‘è¢«èª¤åˆ¤ | å°è³‡æ–™ä¸è¶³çš„ç­–ç•¥æ›´ä¿å®ˆï¼Œæé†’éœ€è£œæ¨£æœ¬ã€‚ã€F:js/overfit-score.jsâ€ L690-L695ã€‘ |
| Walk-forward | æ¸¬è©¦å ±é…¬ä»¥æ—¥å ±é…¬åŠ ç¸½è¿‘ä¼¼ `\bar r_k` | èˆ‡å¹³å‡å ±é…¬å·®ç•°æ¥µå°ï¼Œä¸”æ›´è²¼è¿‘è³‡é‡‘æ›²ç·šè¡¨ç¾ã€‚ã€F:js/overfit-score.jsâ€ L699-L727ã€‘ |
| Island | æ˜ç¢ºé™¤ä»¥ `max S_j`ã€å›å‚³åŸå§‹åˆ†æ•¸ | èˆ‡è¦æ ¼å®Œå…¨å°é½Šï¼Œä¸¦æä¾›è¨ºæ–·æ‰€éœ€ä¸­ç¹¼å€¼ã€‚ã€F:js/overfit-score.jsâ€ L864-L894ã€‘ |
| DSR/PSR | å‰ç«¯å…ˆç”¨ Sharpe ä¼°è¨ˆï¼Œå¾Œç«¯å€¼è¦†è“‹ | å¯åœ¨ä¼ºæœç«¯å®Œæˆ bootstrap å¾Œè‡ªå‹•åŒæ­¥çµæœã€‚ã€F:js/overfit-score.jsâ€ L768-L812ã€‘ |
| åŠ æ¬Š | Flow ç¼ºå€¼æœƒé‡æ–°æ­£è¦åŒ–ï¼›Strategy ç¼ºå€¼è¦–ç‚º 0 åˆ†ä½†ä¿ç•™åŸæ¬Šé‡ | é¿å… Flow è³‡æ–™ç¼ºå¤±æ™‚æ•´é«”å´©æ½°ï¼ŒåŒæ™‚ç¶­æŒç­–ç•¥å±¤èˆ‡è¦æ ¼ä¸€è‡´ã€‚ã€F:js/overfit-score.jsâ€ L308-L352ã€‘ã€F:js/overfit-score.jsâ€ L1131-L1162ã€‘ã€F:js/overfit-score.jsâ€ L1217-L1262ã€‘ |

---
## 6. æŒ‡æ¨™å…¬å¼ç¸½è¡¨ï¼ˆLB-OFI-TABLE-20251013Aï¼‰

ä¸‹è¡¨å½™æ•´ OFI æ‰€æœ‰æ§‹é¢ã€è¨ˆç®—å…¬å¼èˆ‡æ¬Šé‡ï¼Œå¯æ­é… [ä¸‹è¼‰ç”¨ CSV](../assets/ofi-metrics-parameters.csv) äº¤å‰æª¢æŸ¥è¨­å®šï¼›æ‰¹é‡å„ªåŒ–é é¢äº¦æä¾›ã€ŒæŸ¥çœ‹ OFI æŒ‡æ¨™è¡¨ã€æŒ‰éˆ•ï¼Œæœƒç›´æ¥è¼‰å…¥æ­¤è³‡æ–™ä¸¦å¯ä¸€éµä¸‹è¼‰ã€‚

| å±¤ç´š | æ§‹é¢ / æŒ‡æ¨™ | è¨ˆç®—å…¬å¼ | æ­£è¦åŒ– / é–€æª» | æ¬Šé‡ / åƒæ•¸ | å‚™è¨» |
| --- | --- | --- | --- | --- | --- |
| å‰ç½® | CSCV åˆ†æ®µ | å°‡æ¯æ—¥å ±é…¬åˆ‡æˆ `S` æ®µï¼Œ`S=desiredSegments=10`ï¼Œ`|I_t|=|O_t|=S/2` | æ¯æ®µè‡³å°‘ `minPointsPerSegment=5` ç­†æ¨£æœ¬ï¼Œç„¡æ³•å‡åˆ†æ™‚å‰æ®µè£œä¸€ç­† | èšåˆå­ `agg=median`ï¼ˆå¯æ”¹ `mean`ï¼‰ | åƒè€ƒ `DEFAULT_CONFIG.desiredSegments` èˆ‡ `aggregator` è¨­å®šã€‚ã€F:js/overfit-score.jsâ€ L9-L29ã€‘ã€F:js/overfit-score.jsâ€ L248-L288ã€‘ |
| Strategy | `\tilde m_k` | OOS ä¸­ä½æ•¸ | P10/P90 åˆ†ä½å¤¾ä½è‡³ [0,1] | - | æ ¸å¿ƒç©©å¥åº¦æŒ‡æ¨™ã€‚ã€F:js/overfit-score.jsâ€ L668-L696ã€‘ |
| Strategy | `\text{IQR}_k` | OOS IQR | P10/P90 åˆ†ä½å¤¾ä½è‡³ [0,1] | - | ç¼ºå€¼è¦–ç‚º 1ï¼Œä»£è¡¨æœ€å·®ç©©å¥åº¦ã€‚ã€F:js/overfit-score.jsâ€ L690-L695ã€‘ |
| Strategy | `R^{OOS}_k` | `0.6 Â· \text{mid\_norm}_k + 0.4 Â· (1 - \text{iqr\_norm}_k)` | `mid\_norm`ã€`iqr\_norm` å‡é™åˆ¶åœ¨ [0,1] | `Î± = oosAlpha = 0.6` | æé†’æ¨£æœ¬ä¸è¶³æ™‚åä¿å®ˆã€‚ã€F:js/overfit-score.jsâ€ L694-L695ã€‘ |
| Strategy | `\text{WR}_k` | `\text{WR}_k = \frac{1}{W}\sum 1_{r_{k,w}>0}` | å·²åœ¨ [0,1] | - | Walk-forward å‹ç‡ã€‚ã€F:js/overfit-score.jsâ€ L730-L756ã€‘ |
| Strategy | `\bar r_k` | `\bar r_k = \frac{1}{W}\sum r_{k,w}`ï¼ˆä»¥æ—¥å ±é…¬ç¸½å’Œè¿‘ä¼¼ï¼‰ | P10/P90 æ­£è¦åŒ–ç‚º `ret_norm` | - | åæ˜  OOS å¹³å‡å ±é…¬ã€‚ã€F:js/overfit-score.jsâ€ L699-L727ã€‘ |
| Strategy | `R^{WF}_k` | `0.6 Â· \text{WR}_k + 0.4 Â· \text{ret\_norm}_k` | `ret_norm` é™åˆ¶åœ¨ [0,1] | æ¬Šé‡æ¯” `(0.6, 0.4)` | åŠ æ¬Šå‹ç‡èˆ‡å ±é…¬ã€‚ã€F:js/overfit-score.jsâ€ L724-L726ã€‘ |
| Strategy | `S_j` | `S_j = A^{norm}_j Â· (1 - D^{norm}_j) Â· (1 - E^{pen}_j)` | - | - | ä»¥æœ€å¤§å³¶å¶¼ç‚º 1 æ­£è¦åŒ–ã€‚ã€F:js/overfit-score.jsâ€ L864-L894ã€‘ |
| Strategy | `R^{Island}_k` | `R^{Island}_k = S_{j(k)} / \max_j S_j` | çµæœè½åœ¨ [0,1] | - | `meta` å›å‚³ raw èˆ‡ normalised å€¼ã€‚ã€F:js/overfit-score.jsâ€ L864-L894ã€‘ |
| Strategy | `\text{PSR}_k` | `\Pr(\text{Sharpe} > \theta)` | `\theta = dsrSharpeThreshold = 0` | - | ä¼ºæœç«¯å¯è¦†è“‹å‰ç«¯ä¼°è¨ˆã€‚ã€F:js/overfit-score.jsâ€ L798-L804ã€‘ |
| Strategy | `\text{DSR}_k` | `\sigma(Î· Â· z)`ï¼Œ`z = \text{Sharpe}Â·\sqrt{n-1}` | å¤¾ä½ [0,1] | `Î· = dsrLogisticEta = 0.5` | äº¦æ”¯æ´ä¼ºæœç«¯å‚³å›æ©Ÿç‡ã€‚ã€F:js/overfit-score.jsâ€ L780-L793ã€‘ |
| Strategy | `R^{DSR/PSR}_k` | `\max(\text{PSR}_k, \text{DSR}_k)` | - | æ¬Šé‡ `Î³_1 = 0.25` | å–è¼ƒä¿å®ˆçš„é¡¯è‘—æ€§ä¼°è¨ˆã€‚ã€F:js/overfit-score.jsâ€ L780-L795ã€‘ã€F:js/overfit-score.jsâ€ L1131-L1162ã€‘ |
| Strategy | `R^{Strategy}_k` | `0.25 R^{DSR/PSR}_k + 0.25 R^{OOS}_k + 0.25 R^{WF}_k + 0.25 R^{Island}_k` | ç¼ºå€¼è¦–ç‚º 0 åˆ† | `Î³ = (0.25, 0.25, 0.25, 0.25)` | æ¯ç­–ç•¥ç¨ç«‹è¨ˆç®—ä¸¦ç¬¦åˆè¦æ ¼ã€‚ã€F:js/overfit-score.jsâ€ L1131-L1162ã€‘ã€F:js/overfit-score.jsâ€ L1217-L1233ã€‘ |
| ç¶œåˆ | `OFI_k` | `100 Â· (0.30 R^{Flow} + 0.70 R^{Strategy}_k)` | ç¼ºå€¼è¦–ç‚º 0 åˆ†ä½†ä¿ç•™æ¬Šé‡ | `w_F = 0.30`ã€`w_S = 0.70` | è¼¸å‡º 0â€“100 åˆ†ä¸¦é™„è©•èªã€‚ã€F:js/overfit-score.jsâ€ L1131-L1162ã€‘ã€F:js/overfit-score.jsâ€ L1235-L1262ã€‘ |
| ç¶œåˆ | Verdict é–€æª» | ğŸ‘ â‰¥ 80ã€âœ… 65â€“79ã€ğŸ˜ 50â€“64ã€âš ï¸ < 50 | - | - | è³‡æ–™ä¸è¶³æ™‚é¡¯ç¤ºã€Œè³‡æ–™ä¸è¶³ã€ã€‚ã€F:js/overfit-score.jsâ€ L1186-L1197ã€‘ |
| Strategy | `\tilde m_k` | OOS ä¸­ä½æ•¸ | P10/P90 åˆ†ä½å¤¾ä½è‡³ [0,1] | - | æ ¸å¿ƒç©©å¥åº¦æŒ‡æ¨™ã€‚ã€F:js/overfit-score.jsâ€ L465-L517ã€‘ |
| Strategy | `\text{IQR}_k` | OOS IQR | P10/P90 åˆ†ä½å¤¾ä½è‡³ [0,1] | - | ç¼ºå€¼è¦–ç‚º 1ï¼Œä»£è¡¨æœ€å·®ç©©å¥åº¦ã€‚ã€F:js/overfit-score.jsâ€ L505-L521ã€‘ |
| Strategy | `R^{OOS}_k` | `0.6 Â· \text{mid\_norm}_k + 0.4 Â· (1 - \text{iqr\_norm}_k)` | `mid\_norm`ã€`iqr\_norm` å‡é™åˆ¶åœ¨ [0,1] | `Î± = oosAlpha = 0.6` | æé†’æ¨£æœ¬ä¸è¶³æ™‚åä¿å®ˆã€‚ã€F:js/overfit-score.jsâ€ L505-L523ã€‘ |
| Strategy | `\text{WR}_k` | `\text{WR}_k = \frac{1}{W}\sum 1_{r_{k,w}>0}` | å·²åœ¨ [0,1] | - | Walk-forward å‹ç‡ã€‚ã€F:js/overfit-score.jsâ€ L525-L556ã€‘ |
| Strategy | `\bar r_k` | `\bar r_k = \frac{1}{W}\sum r_{k,w}`ï¼ˆä»¥æ—¥å ±é…¬ç¸½å’Œè¿‘ä¼¼ï¼‰ | P10/P90 æ­£è¦åŒ–ç‚º `ret_norm` | - | åæ˜  OOS å¹³å‡å ±é…¬ã€‚ã€F:js/overfit-score.jsâ€ L541-L579ã€‘ |
| Strategy | `R^{WF}_k` | `0.6 Â· \text{WR}_k + 0.4 Â· \text{ret\_norm}_k` | `ret_norm` é™åˆ¶åœ¨ [0,1] | æ¬Šé‡æ¯” `(0.6, 0.4)` | åŠ æ¬Šå‹ç‡èˆ‡å ±é…¬ã€‚ã€F:js/overfit-score.jsâ€ L557-L568ã€‘ |
| Strategy | Island é–€æª» | `\tau = P75(G)` | é«˜æ–¼é–€æª»çš„æ ¼é»é€²å…¥å³¶æ¢ç´¢ | - | æ¡ 8 é€£é€šå°‹æ‰¾å³¶å¶¼ã€‚ã€F:js/overfit-score.jsâ€ L644-L811ã€‘ |
| Strategy | `A^{norm}_j` | é¢ç©ä»¥ P25/P95 æ­£è¦åŒ– | å¤¾ä½ [0,1] | - | åæ˜ ç©©å®šé«˜åŸé¢ç©ã€‚ã€F:js/overfit-score.jsâ€ L812-L860ã€‘ |
| Strategy | `D^{norm}_j` | IQR ä»¥ P25/P95 æ­£è¦åŒ– | å¤¾ä½ [0,1] | - | ä»£è¡¨å³¶å…§åˆ†æ•£åº¦ã€‚ã€F:js/overfit-score.jsâ€ L812-L860ã€‘ |
| Strategy | `E^{pen}_j` | é‚Šç·£æ‡²ç½°å–è² å€¼å¾Œ P25/P95 æ­£è¦åŒ– | å¤¾ä½ [0,1] | - | é¿å…å°–éŠ³é‚Šç•Œã€‚ã€F:js/overfit-score.jsâ€ L812-L860ã€‘ |
| Strategy | `S_j` | `S_j = A^{norm}_j Â· (1 - D^{norm}_j) Â· (1 - E^{pen}_j)` | - | - | ä»¥æœ€å¤§å³¶å¶¼ç‚º 1 æ­£è¦åŒ–ã€‚ã€F:js/overfit-score.jsâ€ L598-L642ã€‘ |
| Strategy | `R^{Island}_k` | `R^{Island}_k = S_{j(k)} / \max_j S_j` | çµæœè½åœ¨ [0,1] | - | `meta` å›å‚³ raw èˆ‡ normalised å€¼ã€‚ã€F:js/overfit-score.jsâ€ L598-L642ã€‘ |
| Strategy | `\text{PSR}_k` | `\Pr(\text{Sharpe} > \theta)` | `\theta = dsrSharpeThreshold = 0` | - | ä¼ºæœç«¯å¯è¦†è“‹å‰ç«¯ä¼°è¨ˆã€‚ã€F:js/overfit-score.jsâ€ L580-L606ã€‘ |
| Strategy | `\text{DSR}_k` | `\sigma(Î· Â· z)`ï¼Œ`z = \text{Sharpe}Â·\sqrt{n-1}` | å¤¾ä½ [0,1] | `Î· = dsrLogisticEta = 0.5` | äº¦æ”¯æ´ä¼ºæœç«¯å‚³å›æ©Ÿç‡ã€‚ã€F:js/overfit-score.jsâ€ L604-L617ã€‘ |
| Strategy | `R^{DSR/PSR}_k` | `\max(\text{PSR}_k, \text{DSR}_k)` | - | æ¬Šé‡ `Î³_1 = 0.25` | å–è¼ƒä¿å®ˆçš„é¡¯è‘—æ€§ä¼°è¨ˆã€‚ã€F:js/overfit-score.jsâ€ L604-L617ã€‘ã€F:js/overfit-score.jsâ€ L986-L1019ã€‘ |
| Strategy | `R^{Strategy}_k` | `0.25 R^{DSR/PSR}_k + 0.25 R^{OOS}_k + 0.25 R^{WF}_k + 0.25 R^{Island}_k` | ç¼ºå€¼æ™‚é‡ç®—æœ‰æ•ˆæ¬Šé‡ | `Î³ = (0.25, 0.25, 0.25, 0.25)` | æ¯ç­–ç•¥ç¨ç«‹è¨ˆç®—ã€‚ã€F:js/overfit-score.jsâ€ L986-L1019ã€‘ |
| ç¶œåˆ | `OFI_k` | `100 Â· (0.30 R^{Flow} + 0.70 R^{Strategy}_k)` | - | `w_F = 0.30`ã€`w_S = 0.70` | è¼¸å‡º 0â€“100 åˆ†ä¸¦é™„è©•èªã€‚ã€F:js/overfit-score.jsâ€ L986-L1051ã€‘ |
| ç¶œåˆ | Verdict é–€æª» | ğŸ‘ â‰¥ 80ã€âœ… 65â€“79ã€ğŸ˜ 50â€“64ã€âš ï¸ < 50 | - | - | è³‡æ–™ä¸è¶³æ™‚é¡¯ç¤ºã€Œè³‡æ–™ä¸è¶³ã€ã€‚ã€F:js/overfit-score.jsâ€ L1033-L1051ã€‘ |

å¦‚éœ€åœ¨ UI é¡¯ç¤ºæ›´å¤šç´°ç¯€ï¼Œå¯ç›´æ¥è®€å– `result.ofiComponents` èˆ‡ `result.meta.island`ï¼›è‹¥éœ€é€²ä¸€æ­¥é©—è­‰æµç¨‹ï¼Œå¯åˆ©ç”¨ `flow.lambda` / `flow.qValues` é‡ç¹ª CSCV åˆ†å¸ƒã€‚é‚„æƒ³è¿½è¹¤å“ªå€‹æŒ‡æ¨™çš„èª¿æ•´å°ä½¿ç”¨è€…æ±ºç­–å½±éŸ¿æœ€å¤§å‘¢ï¼Ÿ
